<!-- /postcard_1/index_postcard1.html -->
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Postcard 1 · A5 · marker bottom-right (upright)</title>
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>body{margin:0;overflow:hidden}</style>

  <script>
    // ПУТИ (замени при необходимости)
    const DRAWING_URL = "https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-1.png";
    const PATT_URL    = "https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-1.patt";

    // mm-align: локальные координаты ОТНОСИТЕЛЬНО маркера (центр маркера = 0,0,0)
    AFRAME.registerComponent('mm-align', {
      schema: {
        w:{type:'number',default:130},  // мм — ширина рисунка
        h:{type:'number',default:160},  // мм — высота рисунка
        x:{type:'number',default:-175}, // мм — влево(−)/вправо(+)
        y:{type:'number',default:35},   // мм — вверх(+)/вниз(−)
        z:{type:'number',default:0},    // мм — к камере
        orientation:{type:'string',default:'upright'} // 'upright' | 'flat'
      },
      update: function(){
        const mm = 0.001;
        const d = this.data;
        // размер (если у примитива есть width/height)
        if (this.el.getAttribute('width')  !== null) this.el.setAttribute('width',  d.w*mm);
        if (this.el.getAttribute('height') !== null) this.el.setAttribute('height', d.h*mm);
        // позиция — ЛОКАЛЬНО относительно маркера
        this.el.setAttribute('position', `${d.x*mm} ${d.y*mm} ${d.z*mm}`);
        // ориентация плоскости
        this.el.setAttribute('rotation', d.orientation === 'flat' ? '-90 0 0' : '0 0 0');
      }
    });
  </script>
</head>
<body>
  <a-scene vr-mode-ui="enabled:false" embedded
           arjs="sourceType: webcam; debugUIEnabled:false;"
           renderer="logarithmicDepthBuffer:true;">
    <a-assets timeout="20000">
      <img id="drawing1" crossorigin="anonymous" src="">
    </a-assets>

    <!-- ВАЖНО: size должен совпадать с физическим размером печатного маркера (0.05 = 50 мм) -->
    <a-marker id="marker" type="pattern" size="0.05" emitevents="true" url="">
      <!-- (опционально) подложка A5 для контроля геометрии, можно убрать -->
      <a-plane position="-0.105 0.074 0.0005"
               width="0.21" height="0.148"
               rotation="0 0 0" 
               material="color:#00ffff; opacity:0.08; side:double"></a-plane>

      <!-- сам AR-рисунок: плоскость с текстурой -->
      <a-plane id="ar-plane"
               material="src:#drawing1; transparent:true; alphaTest:0; opacity:1; side:double; shader:flat"
               mm-align="w:1300; h:1600; x:-4000; y:35; z:0; orientation:flat"> // Перенос вершины в плоскость х
      </a-plane>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // подставляем ресурсы
    document.getElementById('drawing1').setAttribute('src', DRAWING_URL);
    document.getElementById('marker').setAttribute('url', PATT_URL);
  </script>
</body>
</html>





