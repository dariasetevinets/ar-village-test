<!DOCTYPE html>
<html lang="ru">
<head><meta charset="UTF-8" />
  <title>–°–µ—Ç–µ–≤–∏–Ω–µ—Ü –î–∞—Ä—å—è —Ö Twin–ü–ª–µ—Å</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <script src="https://aframe.io/releases/1.4.0/aframe.min.js">
function fadeReplaceText(id, newText) {
  const el = document.getElementById(id);
  if (!el) return;
  el.classList.add('fade-text');
  el.classList.add('hidden');
  setTimeout(() => {
    el.textContent = newText;
    el.classList.remove('hidden');
  }, 200);
}
</script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
  <style>
    .fade-text {
  transition: opacity 0.3s ease, transform 0.3s ease;
  opacity: 1;
  transform: translateY(0);
}
    .fade-text.hidden {
  opacity: 0;
  transform: translateY(6px);
}
    body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; }
    .status {
      position: fixed; bottom: 20px; left: 0; right: 0;
      text-align: center; color: #fff; font-family: Arial, sans-serif;
      background: rgba(0,0,0,.5); padding: 10px; z-index: 100;
    }
    .title.fade-text {
  transition: opacity 0.3s ease, transform 0.3s ease;
  opacity: 1;
  transform: translateY(0);
}
.title.hidden {
  opacity: 0;
  transform: translateY(-6px);
}

.title {
      position: fixed; top: 12px; left: 0; right: 0;
      text-align: center; font: 600 18px/1.2 Arial, sans-serif;
      color: #fff; z-index: 120; padding: 10px 14px; pointer-events: none;
      text-shadow: 0 2px 12px rgba(0,0,0,.6);
      transition: opacity .25s ease, transform .25s ease;
    }
    .title.hidden { opacity: 0; transform: translateY(-6px); }
    @media (max-width: 480px) { .title { font-size: 16px; } }
      .title.hidden { opacity: 0; transform: translateY(-6px); }
    @media (max-width: 480px) { .title { font-size: 16px; } }

    /* Work name (shows after marker recognition) */
    .work-name {
      position: fixed; top: 52px; left: 0; right: 0;
      text-align: center; font: 700 18px/1.2 Arial, sans-serif;
      color: #fff; z-index: 121; padding: 6px 10px; pointer-events: none;
      text-shadow: 0 2px 12px rgba(0,0,0,.6);
      transition: opacity .25s ease, transform .25s ease;
    }
    .work-name.hidden { opacity: 0; transform: translateY(-6px); }

    /* About button & panel */
    .about-btn {
      position: fixed; right: 16px; bottom: 16px; z-index: 130;
      background: rgba(0,0,0,.75); color: #fff; border: 0; border-radius: 999px;
      padding: 12px 14px; font: 500 14px/1 Arial, sans-serif; cursor: pointer;
      box-shadow: 0 4px 20px rgba(0,0,0,.3);
    }
    .about-btn:active { transform: translateY(1px); }

    .about-panel.fade-text { transition: opacity 0.3s ease, transform 0.3s ease; opacity: 1; transform: translateY(0); }
.about-panel.fade-text.hidden { opacity: 0; transform: translateY(10px); }
.about-panel {
      position: fixed; right: 16px; bottom: 64px; width: min(90vw, 320px);
      background: rgba(0,0,0,.85); color: #fff; z-index: 140; border-radius: 12px; padding: 12px;
      box-shadow: 0 8px 24px rgba(0,0,0,.35); backdrop-filter: blur(6px);
    }
    .about-panel.hidden { display: none; }
    .about-header { display: flex; align-items: center; justify-content: space-between; gap: 8px; margin-bottom: 8px; }
    .about-close { background: none; border: 0; color: #fff; font-size: 20px; line-height: 1; cursor: pointer; padding: 4px; }
    .about-content { font: 14px/1.45 Arial, sans-serif; opacity: .95; }
    .about-content a { color: #a5d8ff; text-decoration: underline; }
  </style>
</head>
<body>
  <div class="status">–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä</div>
  <div class="title fade-text" id="title">–°–µ—Ç–µ–≤–∏–Ω–µ—Ü –î–∞—Ä—å—è —Ö Twin–ü–ª–µ—Å</div>
  <div class="work-name hidden fade-text" id="workName">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã</div>

  <button class="about-btn" id="aboutBtn" type="button">–æ –ø—Ä–æ–µ–∫—Ç–µ</button>
  <div class="about-panel hidden fade-text" id="aboutPanel" role="dialog" aria-modal="true" aria-labelledby="aboutTitle">
    <div class="about-header">
      <select id="langSwitch" style="margin-left:auto; background:rgba(255,255,255,0.1); color:#fff; border:0; padding:4px 8px; font: 12px Arial, sans-serif; border-radius:4px;">
        <option value="ru">üá∑üá∫ RU</option>
        <option value="en">üá¨üáß EN</option>
      </select>
      <strong id="aboutTitle">–û –ø—Ä–æ–µ–∫—Ç–µ</strong> <!-- localized -->
      <button id="aboutClose" class="about-close" aria-label="–ó–∞–∫—Ä—ã—Ç—å">√ó</button>
    </div>
    <div class="about-content">
      <p><strong id="labelTitle">–ù–∞–∑–≤–∞–Ω–∏–µ:</strong> <span id="aboutWorkName" class="fade-text">–ù–∞–∑–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã</span></p>
      <p><strong id="labelAuthor">–ê–≤—Ç–æ—Ä:</strong> <span id="aboutAuthor" class="fade-text">‚Äî</span></p>
      <p><strong id="labelDesc">–û–ø–∏—Å–∞–Ω–∏–µ:</strong> <span id="aboutDescription" class="fade-text">‚Äî</span></p>
    </div>
  </div>

  <!-- Assets -->
  <a-scene
    vr-mode-ui="enabled: false"
    embedded
    arjs="sourceType: webcam; detectionMode: mono; cameraParametersUrl: https://raw.githack.com/AR-js-org/AR.js/master/data/data/camera_para.dat"
    renderer="logarithmicDepthBuffer: true;"
  >
    <a-assets timeout="30000">
      <img id="main-texture" crossorigin="anonymous"
           src="https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-1.png" />

      <!-- Vertex Shader -->
      <script id="vertexShader" type="x-shader/x-vertex">
        varying vec2 vUv;
        uniform float intensity;
        void main () {
          vUv = uv;
          // –ù–µ–±–æ–ª—å—à–∞—è –≤–æ–ª–Ω–∞ –ø–æ –≤–µ—Ä—Ç–µ–∫—Å–∞–º (–º—è–≥–∫–æ, —á—Ç–æ–±—ã –Ω–µ –ª–æ–º–∞—Ç—å –º–∞—Ä–∫–µ—Ä)
          float waveX = sin(position.x * 4.0) * 0.02 * intensity;
          float waveY = cos(position.y * 3.0) * 0.02 * intensity;
          vec3 newPosition = position + vec3(waveX, waveY, 0.0);
          gl_Position = projectionMatrix * modelViewMatrix * vec4(newPosition, 1.0);
        }
      </script>

      <!-- Fragment Shader (jitter) -->
      <script id="jitterShader" type="x-shader/x-fragment">
        #ifdef GL_FRAGMENT_PRECISION_HIGH
          precision highp float;
        #else
          precision mediump float;
        #endif
        uniform sampler2D map;
        uniform float time;
        uniform float intensity;
        varying vec2 vUv;
        void main () {
          // –ê–º–ø–ª–∏—Ç—É–¥–∞ ‚Äî –º–∞–ª–µ–Ω—å–∫–∞—è, —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è intensity
          float baseAmp = 0.015 * intensity;
          float jitter = sin(time * 12.0) * baseAmp;

          vec2 uv = vUv + vec2(
            jitter * sin(time * 3.0 + vUv.y * 15.0),
            jitter * cos(time * 2.5 + vUv.x * 12.0)
          );

          // –ö–ª–∞–º–ø, —á—Ç–æ–±—ã –Ω–µ —É–ø–∏—Ä–∞—Ç—å—Å—è –≤ –ø—Ä–æ–∑—Ä–∞—á–Ω—ã–µ/–æ–¥–Ω–æ—Ü–≤–µ—Ç–Ω—ã–µ –∫—Ä–∞—è
          uv = clamp(uv, vec2(0.001), vec2(0.999));

          vec4 color = texture2D(map, uv);
          // –õ–µ–≥–∫–∏–π RGB-split –¥–ª—è –≤–∏–¥–∏–º–æ—Å—Ç–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞
          color.r = texture2D(map, clamp(uv + vec2( 0.01 * intensity, 0.0), vec2(0.001), vec2(0.999))).r;
          color.g = texture2D(map, clamp(uv + vec2( 0.0, 0.01 * intensity), vec2(0.001), vec2(0.999))).g;
          color.b = texture2D(map, clamp(uv + vec2(-0.008 * intensity, -0.008 * intensity), vec2(0.001), vec2(0.999))).b;

          // –ù–µ–±–æ–ª—å—à–∞—è –ø—É–ª—å—Å–∞—Ü–∏—è –∞–ª—å—Ñ—ã
          color.a *= 0.85 + 0.15 * sin(time * 8.0);
          gl_FragColor = color;
        }
      </script>
    </a-assets>

    <script>
      // –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º ShaderMaterial –∫ –º–µ—à—É A-Frame
      AFRAME.registerComponent('jitter-effect', {
        schema: {
        speed: { type: 'number', default: 2.0 },
        intensity: { type: 'number', default: 1.5 },
        texId: { type: 'string', default: 'main-texture' }
      },

        init: function () {
          this.material = null;
          this._time = 0;

          // –ì–æ—Ç–æ–≤–∏–º —Ç–µ–∫—Å—Ç—É—Ä—É –∏–∑ <img id="main-texture">, —É–∂–µ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –≤ <a-assets>
          const img = document.getElementById('main-texture');
          if (!img || !img.complete) {
            // –ñ–¥—ë–º –∞—Å—Å–µ—Ç–∞, –µ—Å–ª–∏ —á—Ç–æ
            img?.addEventListener('load', () => this._buildMaterial(img));
          } else {
            this._buildMaterial(img);
          }

          // –ü—Ä–∏–º–µ–Ω—è—Ç—å –º–∞—Ç–µ—Ä–∏–∞–ª, –∫–æ–≥–¥–∞ –ø–æ—è–≤–∏—Ç—Å—è mesh
          this.el.addEventListener('loaded', () => this._applyWhenReady());
          this.el.addEventListener('object3dset', (e) => {
            if (e.detail && e.detail.type === 'mesh') this._applyWhenReady();
          });
        },

        _buildMaterial: function (imgEl) {
          const texEl = document.getElementById(this.data.texId || 'main-texture');
          if (!texEl || !texEl.complete) return;
          const texture = new THREE.Texture(texEl);
          texture.needsUpdate = true;
          texture.colorSpace = THREE.SRGBColorSpace;
          texture.minFilter = THREE.LinearFilter;
          texture.magFilter = THREE.LinearFilter;
          texture.wrapS = THREE.ClampToEdgeWrapping;
          texture.wrapT = THREE.ClampToEdgeWrapping;

          this.material = new THREE.ShaderMaterial({
            uniforms: {
              map: { value: null },
              time: { value: 0 },
              intensity: { value: this.data.intensity }
            },
            vertexShader: document.getElementById('vertexShader').textContent,
            fragmentShader: document.getElementById('jitterShader').textContent,
            transparent: true,
            depthWrite: false, // –≤–∞–∂–Ω–æ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∞–ª—å—Ñ–∞-–±–ª–µ–Ω–¥–∞ –≤ AR
            side: THREE.DoubleSide // –ø–ª–æ—Å–∫–æ—Å—Ç—å –≤–∏–¥–Ω–∞ —Å –æ–±–µ–∏—Ö —Å—Ç–æ—Ä–æ–Ω
          });
        },

        _applyWhenReady: function () {
          const mesh = this.el.getObject3D('mesh');
          if (!mesh || !this.material) return;
          mesh.traverse((obj) => {
            if (obj.isMesh) {
              obj.material = this.material;
              obj.material.needsUpdate = true; // –≤–∞–∂–Ω–æ –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞
            }
          });
          // console.log('Jitter material applied');
        },

        tick: function (time, dt) {
          if (!this.material) return;
          // A-Frame –¥–∞—ë—Ç time –≤ –º—Å. –î–µ–ª–∞–µ–º –Ω–∞–∫–æ–ø–∏—Ç–µ–ª—å–Ω—ã–π —Å—á—ë—Ç—á–∏–∫ (—É—Å—Ç–æ–π—á–∏–≤–µ–µ, —á–µ–º mod)
          this._time += (dt || 0) * 0.001 * this.data.speed;
          this.material.uniforms.time.value = this._time;
        },

        update: function (oldData) {
          if (!this.material) return;
          if (oldData.intensity !== this.data.intensity) {
            this.material.uniforms.intensity.value = this.data.intensity;
          }
        },

        remove: function () {
          if (this.material) {
            const tex = this.material.uniforms.map?.value;
            this.material.dispose();
            if (tex && tex.dispose) tex.dispose();
            this.material = null;
          }
        }
      });
    </script>

    <!-- –ú–∞—Ä–∫–µ—Ä(—ã) –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ POSTCARDS -->

    <!-- –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ –ø–æ–∑—ã –º–∞—Ä–∫–µ—Ä–∞ ‚Üí –º–µ–Ω—å—à–µ –¥—Ä–æ–∂–∞–Ω–∏—è -->
    
    </a-entity>

    <a-entity camera></a-entity>
  </a-scene>

  <script>
    // –°—Ç–∞—Ç—É—Å —Ç–µ–ø–µ—Ä—å —Å–ª—É—à–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–º–µ–Ω–Ω–æ –Ω–∞ a-marker
    const sceneEl = document.querySelector('a-scene');
    const assetsEl = sceneEl.querySelector('a-assets');
    const statusEl = document.querySelector('.status');
    const titleEl = document.getElementById('title');
    const workNameEl = document.getElementById('workName');
    const aboutBtn = document.getElementById('aboutBtn');
    const aboutPanel = document.getElementById('aboutPanel');
    const aboutClose = document.getElementById('aboutClose');
    const aboutWorkName = document.getElementById('aboutWorkName');

    // === –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è 7 –æ—Ç–∫—Ä—ã—Ç–æ–∫ ===
    let userLang = localStorage.getItem('ar-lang') || (navigator.language.startsWith('en') ? 'en' : 'ru');

const POSTCARDS = [
  { id: 'pc1', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 1', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-1.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-1.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 6.0, intensity: 0.5 }, author: { ru: '$1', en: 'Author of $1' }, description: { ru: '$2', en: 'Description of $2' } },
  { id: 'pc2', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 2', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-2.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-2.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 4.0, intensity: 1.0 }, author: '–ê–≤—Ç–æ—Ä 2', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 2' },
  { id: 'pc3', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 3', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-3.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-3.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 2.0, intensity: 2.0 }, author: '–ê–≤—Ç–æ—Ä 3', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 3' },
  { id: 'pc4', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 4', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-4.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-4.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 1.5, intensity: 0.8 }, author: '–ê–≤—Ç–æ—Ä 4', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 4' },
  { id: 'pc5', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 5', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-5.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-5.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 3.5, intensity: 1.2 }, author: '–ê–≤—Ç–æ—Ä 5', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 5' },
  { id: 'pc6', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 6', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-6.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-6.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 2.5, intensity: 0.6 }, author: '–ê–≤—Ç–æ—Ä 6', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 6' },
  { id: 'pc7', title: '–û—Ç–∫—Ä—ã—Ç–∫–∞ 7', pattUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/patterns/sdxtp-7.patt', imgUrl: 'https://dariasetevinets.github.io/ar-village-test/assets/drawings/setevinets_index-7.png', width: 8.2, height: 5.92, size: 0.05, position: '0 0 0', rotation: '-90 0 0', jitter: { speed: 5.0, intensity: 1.0 }, author: '–ê–≤—Ç–æ—Ä 7', description: '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∫–∏ 7' },
];

    // –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—Å—Ç—É—Ä—ã –≤ <a-assets>
    POSTCARDS.forEach(pc => {
      const img = document.createElement('img');
      img.setAttribute('id', `tex-${pc.id}`);
      img.setAttribute('crossorigin', 'anonymous');
      img.src = pc.imgUrl;
      assetsEl.appendChild(img);
    });

    // –¢—Ä–µ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Ä–∫–µ—Ä–æ–≤
    const active = new Set();

    function updateUI() {
      if (active.size > 0) {
        titleEl?.classList.add('hidden');
        workNameEl?.classList.remove('hidden');
        statusEl.textContent = dict[userLang].markerFound;
      } else {
        titleEl?.classList.remove('hidden');
        workNameEl?.classList.add('hidden');
        statusEl.textContent = dict[userLang].markerLost;
        aboutWorkName && (aboutWorkName.textContent = '');
      }
    }

    // –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ä–∫–µ—Ä–æ–≤ –∏ —Å—É—â–Ω–æ—Å—Ç–µ–π
    POSTCARDS.forEach(pc => {
      // a-marker
      const marker = document.createElement('a-marker');
      marker.setAttribute('id', `marker-${pc.id}`);
      marker.setAttribute('type', 'pattern');
      marker.setAttribute('url', pc.pattUrl);
      marker.setAttribute('size', pc.size || 0.05);
      marker.setAttribute('emitevents', 'true');
      sceneEl.appendChild(marker);

      // –°–º—è–≥—á–µ–Ω–∏–µ –ø–æ–∑—ã
      const smoothed = document.createElement('a-entity');
      smoothed.setAttribute('id', `smoothed-${pc.id}`);
      smoothed.setAttribute('smoothed-controls', `source: #marker-${pc.id}; lerp-position: 0.6; lerp-rotation: 0.3; lerp-scale: 0.6`);
      sceneEl.appendChild(smoothed);

      // –ö–æ–Ω—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç–∫–∏
      const art = document.createElement('a-entity');
      art.setAttribute('id', `art-${pc.id}`);
      art.setAttribute('geometry', `primitive: plane; width: ${pc.width}; height: ${pc.height}`);
      art.setAttribute('position', pc.position || '0 0 0');
      art.setAttribute('rotation', pc.rotation || '-90 0 0');
      art.setAttribute('jitter-effect', `speed: ${pc.jitter?.speed ?? 6.0}; intensity: ${pc.jitter?.intensity ?? 0.5}; texId: tex-${pc.id}`);
      smoothed.appendChild(art);

      // –≠–≤–µ–Ω—Ç—ã
      marker.addEventListener('markerFound', () => {
        active.add(pc.id);
        if (workNameEl) fadeReplaceText('workName', pc.title);
        if (aboutWorkName) fadeReplaceText('aboutWorkName', pc.title);
const authorSpan = document.getElementById('aboutAuthor');
const descSpan = document.getElementById('aboutDescription');
if (authorSpan) fadeReplaceText('aboutAuthor', (typeof pc.author === 'object' ? pc.author[userLang] : pc.author) || '‚Äî');
if (descSpan) fadeReplaceText('aboutDescription', (typeof pc.description === 'object' ? pc.description[userLang] : pc.description) || '‚Äî');
        updateUI();
        console.log(`
üìå –†–∞—Å–ø–æ–∑–Ω–∞–Ω–∞ ${pc.title}
–ê–≤—Ç–æ—Ä: ${pc.author}
–û–ø–∏—Å–∞–Ω–∏–µ: ${pc.description}
Jitter: speed=${pc.jitter?.speed}, intensity=${pc.jitter?.intensity}`);
      });
      marker.addEventListener('markerLost', () => {
        active.delete(pc.id);
        updateUI();
      });
    });

    function openAbout() {
  aboutPanel?.classList.add('fade-text');
  aboutPanel?.classList.remove('hidden');
}
    function closeAbout() {
  aboutPanel?.classList.add('hidden');
}

    aboutBtn?.addEventListener('click', () => {
      const hidden = aboutPanel?.classList.contains('hidden');
      if (hidden) openAbout(); else closeAbout();
    });
    aboutClose?.addEventListener('click', closeAbout);
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeAbout(); });

    window.addEventListener('webglcontextlost', () => {
      statusEl.textContent = dict[userLang].webglError;
    }, false);

    const langSelect = document.getElementById('langSwitch');
    langSelect.value = userLang;
    langSelect.addEventListener('change', (e) => {
  userLang = e.target.value;
  localStorage.setItem('ar-lang', userLang);
  updateLabels();
});

function updateLabels() {
  const dict = {
  ru: {
    aboutTitle: '–û –ø—Ä–æ–µ–∫—Ç–µ',
    labelTitle: '–ù–∞–∑–≤–∞–Ω–∏–µ:',
    labelAuthor: '–ê–≤—Ç–æ—Ä:',
    labelDesc: '–û–ø–∏—Å–∞–Ω–∏–µ:',
    markerFound: '–ú–∞—Ä–∫–µ—Ä —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω',
    markerLost: '–ù–∞–≤–µ–¥–∏—Ç–µ –∫–∞–º–µ—Ä—É –Ω–∞ –º–∞—Ä–∫–µ—Ä',
    webglError: '–û—à–∏–±–∫–∞ –≥—Ä–∞—Ñ–∏–∫–∏. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.'
  },
  en: {
    aboutTitle: 'About',
    labelTitle: 'Title:',
    labelAuthor: 'Author:',
    labelDesc: 'Description:',
    markerFound: 'Marker detected',
    markerLost: 'Point your camera at the marker',
    webglError: 'Graphics error. Please reload the page.'
  }
},
    en: {
      aboutTitle: 'About',
      labelTitle: 'Title:',
      labelAuthor: 'Author:',
      labelDesc: 'Description:'
    }
  };
  const d = dict[userLang];
  fadeReplaceText('aboutTitle', d.aboutTitle);
  fadeReplaceText('labelTitle', d.labelTitle);
  fadeReplaceText('labelAuthor', d.labelAuthor);
  fadeReplaceText('labelDesc', d.labelDesc);
  fadeReplaceText('aboutBtn', d.aboutBtn);
  document.getElementById('labelTitle').textContent = d.labelTitle;
  document.getElementById('labelAuthor').textContent = d.labelAuthor;
  document.getElementById('labelDesc').textContent = d.labelDesc;
  document.getElementById('aboutBtn').textContent = d.aboutBtn;
}

updateLabels();</script>
</body>
</html>
